!
function() {
	"use strict";
	function e() {
		var e = "1";
		return T.isMobile && (e = "m1"),
		T.isIos && T.isNative ? e = "am0": T.isAndroid && T.isNative && (e = "am1"),
		e
	}
	function t() {
		var e = k.getValue(j.ptp_cnt_b);
		if (e) return e;
		var t = "",
		n = location.href.split("?")[0];
		return t = q.pageHash(n)
	}
	function n() {
		var e = k.getCookieOrFunc(j.cpsinfo);
		return e ? e = e.replace("-", ",") : ""
	}
	function r(e) {
		if (e) {
			var t = k.getValue(j.urlExtendFn, e);
			return k.hasKey(t) ? t: void 0
		}
	}
	function i(e) {
		if (e) {
			e.length && (e = e[0]);
			var t = k.getValue(j.ptp_cnt_c_d, e);
			if (t) return t;
			var n = e.getAttribute("data-ptp-customc");
			if (n) return {
				c: n,
				d: U.getIndex("data-ptp-customc", n, e)
			};
			if (e = U.getParents(e, "data-ptp-customc")) return n = e.getAttribute("data-ptp-customc"),
			n ? {
				c: n,
				d: U.getIndex("data-ptp-customc", n, e)
			}: void 0
		}
	}
	function o() {
		return k.getCookieOrFunc(j.uuid)
	}
	function a() {
		window.PTP_PARAMS && k.extend(j, window.PTP_PARAMS);
		var e = navigator.userAgent.toLocaleLowerCase();
		return T.isNative = j.isNativeRe.test(e),
		{
			time: k.getTime(),
			ver: "1.1.0",
			uid: k.getCookieOrFunc(j.uid),
			_channel: "",
			"tid-token": "",
			launchTime: k.getTime(),
			active: 0,
			deviceName: "",
			os_ver: "",
			root: 0,
			network: 0,
			provider: "",
			url: location.href,
			refer: document.referrer,
			ptp_url: k.getQuery("ptp", location.search),
			ptp_ref: k.getQuery("ptp", document.referrer ? document.referrer: ""),
			eid: "0",
			ext: {
				cpsparam: k.getCookie("__cps"),
				cpsinfo: n(),
				_notNative: !T.isNative
			}
		}
	}
	function u() {
		H.a = e(),
		H.b = t(),
		H.c = 0,
		H.d = 0
	}
	function c(e, t) {
		t = t || {};
		var n = [];
		for (var r in t) {
			var i = t[r];
			i || (i = ""),
			i = encodeURIComponent(i),
			n.push(r + "=" + i)
		}
		n = n.join("&"),
		e = e.indexOf("?") > -1 ? e + "&" + n: e + "?" + n;
		var o = new Image;
		o.src = e
	}
	function d(e, t) {
		e += "?web=1",
		t = t || {};
		var n, r = z++;
		try {
			n = document.createElement('<iframe name="' + r + '">')
		} catch(i) {
			n = document.createElement("iframe"),
			n.setAttribute("name", r)
		}
		try {
			n.style.display = "none",
			document.body.appendChild(n),
			n.contentWindow.name = r;
			var o = document.createElement("form");
			o.setAttribute("method", "POST"),
			o.setAttribute("action", e),
			o.setAttribute("target", r);
			for (var a in t) if (t.hasOwnProperty(a)) {
				var u = document.createElement("input");
				u.setAttribute("type", "hidden"),
				u.setAttribute("name", a),
				u.setAttribute("value", t[a]),
				o.appendChild(u)
			}
			document.body.appendChild(o),
			o.submit(),
			k.registerEvent(n, "load",
			function() {
				try {
					document.body.removeChild(o),
					document.body.removeChild(n)
				} catch(e) {}
			})
		} catch(i) {
			window.M && M.log(i)
		}
	}
	function f() {
		if (!K) {
			K = !0;
			for (var e = 0; e < J.length; e++) J[e].fn.call(window, J[e].ctx);
			J = []
		}
	}
	function s() {
		"complete" === document.readyState && f()
	}
	function p(e, t) {
		return K ? void setTimeout(function() {
			e(t)
		},
		1) : (J.push({
			fn: e,
			ctx: t
		}), void("complete" === document.readyState || !document.attachEvent && "interactive" === document.readyState ? setTimeout(f, 1) : W || (document.addEventListener ? (document.addEventListener("DOMContentLoaded", f, !1), window.addEventListener("load", f, !1)) : (document.attachEvent("onreadystatechange", s), window.attachEvent("onload", f)), W = !0)))
	}
	function g() {
		return X
	}
	function l(e, t, n) {
		"undefined" != typeof e && (t = t || {},
		n && window.M && M.web.AB && (t.abinfo = M.web.AB.formatAB(n)), p(function() {
			var n = V.getPtpInfoAndExtra(t);
			n.eid = e + "",
			g() ? D.logData("e", k.extend({},
			n)) : k.listenTo("LoggerReady",
			function() {
				var e = V.getPtpInfoAndExtra(t);
				D.logData("e", k.extend({},
				e))
			}),
			window.MtaH5 && MtaH5.clickStat && MtaH5.clickStat(e, t)
		}))
	}
	function v() {
		var e = V.getPtpInfoAndExtra(),
		t = k.getValue(j.pEventId);
		e.eid = t,
		D.logData("p", e)
	}
	function m() {
		if (T.isNative) {
			var e = V.getPtpCnt();
			window.M && M.web.AB && M.web.AB.isAB ? M.web.AB.collectExps().then(function(t) {
				t.length ? D.logAppPevent(e, t) : D.logAppPevent(e)
			}) : D.logAppPevent(e)
		} else g() ? v() : k.listenTo("LoggerReady",
		function() {
			v()
		})
	}
	function h() {
		p(function() {
			V.refreshPtp(),
			V.refreshE(),
			m()
		})
	}
	function w(e) {
		var t = e.href;
		if (! (t.indexOf("mogujie.com/mtalk/") > -1) && (j.hrefRe.test(t) || j.mgjRe.test(t))) {
			var n = e.getAttribute("data-ptp-cache-id");
			t = e.getAttribute("href"),
			n && j.ptpRe.test(n) || (n = V.createPtpCnt(e), e.setAttribute("data-ptp-cache-id", n)),
			e.href = V.makeUrl(t, n, e)
		}
	}
	function y(e) {
		if (e.getAttribute) {
			var t = e.getAttribute("href");
			if (null === t || 0 === t.indexOf("#")) return ! 1
		}
		return ! 0
	}
	function x(e) {
		var t = e || window.event,
		n = t.target || t.srcElement,
		r = U.getA(n),
		i = "AREA" === n.nodeName ? n: null;
		i && (r = i),
		r && (r.href && r.href.indexOf("javascript:") > -1 || y(r) && w(r))
	}
	function A(e, t) {
		if ("undefined" == typeof e) return "";
		var n = "";
		return n = t ? V.createPtpCnt(t) : V.getPtpCnt(),
		V.makeUrl(e, n, t)
	}
	function E() {
		var e = A("");
		e = e.split("?")[1],
		e = e.split("&");
		for (var t, n = "",
		r = 0,
		i = e.length; r < i; r++) t = e[r].split("="),
		n += '<input type="hidden" name="' + t[0] + '" value="' + (t[1] ? t[1] : "") + '"/>';
		return n
	}
	function P(e) {
		e && "string" == typeof e && (e = A(e), window.location.href = e)
	}
	var b = 1001,
	C = {},
	_ = {
		"&": "&amp;",
		"<": "&lt;",
		">": "&gt;",
		'"': "&quot;",
		"'": "&#x27;",
		"`": "&#x60;"
	},
	L = /(&|<|>|"|`|')/g,
	k = {
		escapeHtml: function(e) {
			return e.replace(L,
			function(e) {
				return _[e]
			})
		},
		isIE: function(e) {
			var t = document.createElement("b");
			return t.innerHTML = "<!--[if IE " + e + "]><i></i><![endif]-->",
			1 === t.getElementsByTagName("i").length
		},
		stringify: function(e) {
			var t = this;
			if ("undefined" != typeof JSON) return JSON.stringify(e);
			var n = typeof e;
			if ("object" != n || null === e) return "string" == n && (e = '"' + e + '"'),
			String(e);
			var r, i, o = [],
			a = e && e.constructor == Array;
			for (r in e) i = e[r],
			n = typeof i,
			e.hasOwnProperty(r) && ("string" == n ? i = '"' + i + '"': "object" == n && null !== i && (i = t.stringify(i)), o.push((a ? "": '"' + r + '":') + String(i)));
			return (a ? "[": "{") + String(o) + (a ? "]": "}")
		},
		isArray: function(e) {
			return "[object Array]" == Object.prototype.toString.call(e)
		},
		getCookieInArray: function(e) {
			for (var t = this,
			n = 0,
			r = e.length; n < r; n++) {
				var i = t.getCookie(e[n]);
				if (i) return i
			}
			return ""
		},
		getCookieOrFunc: function(e) {
			return "function" == typeof e ? this.getValue(e) : this.getCookie(e)
		},
		getCookie: function(e) {
			if (this.isArray(e)) return this.getCookieInArray(e);
			var t = document.cookie.match(new RegExp("(^| )" + e + "=([^;]*)(;|$)"));
			return null !== t ? decodeURIComponent(t[2]) : ""
		},
		getQuery: function(e, t) {
			"undefined" == typeof t && (t = location.search);
			var n = "(^|&|\\?)" + e + "=([^&]*)(&|$)",
			r = new RegExp(n, "i"),
			i = t.substr(1).match(r);
			return null !== i ? this.escapeHtml(decodeURIComponent(i[2])) : ""
		},
		setQuery: function(e, t, n) {
			var r = new RegExp("([?&])" + t + "=.*?(&|$)", "i"),
			i = e.indexOf("?") !== -1 ? "&": "?";
			return e.match(r) ? e.replace(r, "$1" + t + "=" + n + "$2") : e + i + t + "=" + n
		},
		getTime: function() {
			return (new Date).getTime()
		},
		registerEvent: function(e, t, n) {
			window.attachEvent ? e.attachEvent("on" + t, n) : e.addEventListener(t, n, !1)
		},
		extend: function() {
			for (var e = arguments,
			t = arguments[0], n = 1; n < e.length; n++) {
				var r = e[n];
				for (var i in r) r.hasOwnProperty(i) && (t[i] = r[i])
			}
			return t
		},
		getValue: function(e) {
			if (e) {
				if ("function" == typeof e) try {
					var t = Array.prototype.slice.call(arguments, 1);
					return e.apply(null, t)
				} catch(n) {
					return window.M && window.M.log("**logger.js---\u6253\u70b9\u51fa\u9519:" + n),
					""
				}
				return e
			}
		},
		loadScript: function(e, t, n) {
			if (window["callback_" + b] = function(e) {
				t && t(e)
			},
			e = this.setQuery(e, "callback", "callback_" + b), b += 1, n) window.loader.script(e,
			function() {},
			function() {});
			else {
				var r = document.createElement("script");
				r.src = e;
				var i = document.getElementsByTagName("head")[0];
				i && i.appendChild(r)
			}
		},
		listenTo: function(e, t) {
			C[e] || (C[e] = []),
			C[e].push(t)
		},
		fire: function(e) {
			var t = C[e];
			if (t && t.length) {
				for (var n = 0,
				r = t.length; n < r; n++) t[n].call();
				C[e] = []
			}
		},
		hasKey: function(e) {
			if (!e) return ! 1;
			for (var t in e) if (e.hasOwnProperty(t)) return ! 0;
			return ! 1
		}
	},
	I = "https:" === location.protocol ? "https:": "http:",
	N = "mogujie";
	location.host.indexOf("meilishuo") != -1 && (N = "meilishuo");
	var j = {
		LogUrl: I + "//log.mogujie.com/log",
		CookieUrl: I + "//portal." + N + ".com/api/util/getUuid",
		shouldRequestCookie: function() {
			var e = k.getCookieOrFunc(this.uuid);
			return ! e
		},
		uuid: ["__mgjuuid", "__xduuid"],
		uid: "__ud_",
		cpsinfo: "__cpsinfo",
		ptp_cnt_a: "",
		ptp_cnt_b: "",
		ptp_cnt_c_d: "",
		platform: function() {
			var e = navigator.userAgent.toLowerCase();
			if (/qq\/([\d\.]+)/.test(e) || /qzone\//.test(e)) return 48
		},
		pEventId: "0",
		isMobileRe: /iphone|android|ipad/i,
		ptpRe: /[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+\.[a-z0-9]+/i,
		hrefRe: /http[s]?:\/\/(\w+\.){1,2}(mogujie|meilishuo|xiaodian|uniny)\.com([\/]|\/.*|)$/,
		mgjRe: /(mgj|mls):\/\//,
		mtRe: /\?.*[&]?mt=([^\.]+)\.([^\.]+)\.([^\.&#]+)/,
		chasing: ["f", "f2", "mlf", "s", "_fu"],
		urlExtend: ["acm"],
		urlExtendFn: function() {},
		extra: {},
		isNativeRe: /(mogujie|meilishuo|mls|mgjtuangou|xiaodian|xcore)/i,
		nativeLog: {}
	},
	O = navigator.userAgent.toLocaleLowerCase(),
	R = !1,
	S = O.indexOf("xcore") > -1;
	S && window.loader && window.loader.script && (R = !0);
	var T = {
		isWX: O.indexOf("micromessenger") > -1,
		isApp: j.isNativeRe.test(O),
		isNative: j.isNativeRe.test(O),
		isMobile: j.isMobileRe.test(O),
		isIos: O.indexOf("iphone") > -1,
		isAndroid: O.indexOf("android") > -1,
		isLowIE: !R && (k.isIE(6) || k.isIE(7) || k.isIE(8)),
		xcore: R
	},
	B = window.jQuery || window.Zepto,
	Q = function(e, t) {
		for (var n = 0,
		r = e.length; n < r; n++) if (e[n] == t) return n + 1;
		return - 1
	},
	U = {
		getA: function(e) {
			var t = e;
			if ("A" == t.tagName) return e;
			for (; t.parentNode;) if (t = t.parentNode, "A" == t.tagName) return t
		},
		getParentByClass: function(e, t) {
			if (e) {
				if (B) return $(e).parents("." + t);
				for (var n, r = e; r.parentNode;) if (r = r.parentNode, n = r.className && r.className.indexOf(t) != -1) return r
			}
		},
		getParents: function(e, t) {
			if (e) {
				if (t = t || "", B) return t = "[" + t + "]",
				$(e).parents(t)[0];
				for (var n, r = e; r.parentNode;) if (r = r.parentNode, n = r.getAttribute && r.getAttribute(t)) return r
			}
		},
		getIndex: function(e, t, n) {
			if (!e || !t || !n) return 0;
			if (B) return $("[" + e + '="' + t + '"]').index($(n)) + 1;
			if (document.querySelectorAll) {
				var r = document.querySelectorAll("[" + e + '="' + t + '"]');
				return Q(r, n)
			}
			return 1
		},
		getElemIndex: function(e, t, n) {
			if (!e || !t || !n) return 0;
			if (B) return $(e).find(t).index($(n)) + 1;
			if (e.querySelectorAll) {
				var r = e.querySelectorAll(t);
				return Q(r, n)
			}
			return 1
		},
		is: function(e, t) {
			return ! (!e || !t) && (e.length && (e = e[0]), e.nodeName.toLowerCase() === t.toLowerCase() || void 0)
		}
	},
	q = {
		arr: "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",
		rand: function(e) {
			var t, n, r = this,
			i = "",
			o = 0;
			for (t = 0; t < e; t++) n = parseInt(Math.random() * r.arr.length, 10),
			i += r.arr.charAt(n),
			o += r.arr.charCodeAt(n);
			return i += this.arr.charAt(o % this.arr.length)
		},
		pageHash: function(e) {
			var t = this,
			n = 5381,
			r = e.length - 1;
			if ("string" == typeof e) for (; r > -1; r--) n += (n << 5) + e.charCodeAt(r);
			else for (; r > -1; r--) n += (n << 5) + e[r];
			var i = 2147483647 & n,
			o = "";
			do o += t.arr.charAt(61 & i),
			i >>= 6;
			while (i);
			return o
		}
	},
	F = a(),
	H = {
		a: e(),
		b: t(),
		c: 0,
		d: 0,
		e: j.ptp_cnt_e ? j.ptp_cnt_e: q.rand(6)
	},
	V = {
		getPlatform: function() {
			var e = k.getValue(j.platform);
			return e ? e: T.isMobile ? 32 : 31
		},
		getPtpByType: function(e) {
			var t = [0, o(), e];
			return t
		},
		getPtpCnt: function(e, t) {
			return e || (e = H.c),
			t || (t = H.d),
			[H.a, H.b, e, t, H.e].join(".")
		},
		getPtpInfo: function() {
			var e = {};
			return k.extend(e, F, {
				ptp_cnt: this.getPtpCnt()
			})
		},
		getPtpInfoAndExtra: function(e) {
			var t = this.getPtpInfo(),
			n = {};
			if (j.extra) for (var r in j.extra) j.extra.hasOwnProperty(r) && (n[r] = k.getValue(j.extra[r]));
			var i = k.extend({},
			t.ext, n, e);
			return k.extend({},
			t, {
				ext: i
			})
		},
		createPtpCnt: function(e) {
			var t = i(e),
			n = 0,
			r = 0;
			if (t) return this.getPtpCnt(t.c, t.d);
			var o = U.getParents(e, "data-ptp"),
			a = U.getParentByClass(e, "data-ptp-item");
			return o && (n = o.getAttribute("data-ptp"), r = a ? U.getElemIndex(o, ".data-ptp-item", a) : U.getElemIndex(o, "a", e)),
			r || (r = 0),
			this.getPtpCnt(n, r)
		},
		makeUrl: function(e, t, n) {
			var r = e.match(/(#.+)$/);
			return e = e.replace(/(#.+)$/, ""),
			e = k.setQuery(e, "ptp", t),
			e = this.getChasingParams(e),
			e = this.getExtendParams(n, e),
			r && (e += r[1]),
			e
		},
		getChasingParams: function(e) {
			"undefined" == typeof e && (e = "");
			var t = e;
			if (!j.chasing) return t;
			j.chasing.length || (j.chasing = [j.chasing]);
			for (var n, r, i = 0,
			o = j.chasing.length; i < o; i++) n = j.chasing[i],
			r = k.getQuery(n),
			r && (t = k.setQuery(t, n, r));
			for (var a = location.search,
			u = /[\?&](_f_[^=]+)=([^&]+)/g,
			c = u.exec(a); c && 3 == c.length;) t = k.setQuery(t, c[1], c[2]),
			c = u.exec(a);
			return t
		},
		getExtendParams: function(e, t) {
			var n = t;
			if (!e || !U.is(e, "a")) return n;
			var i = r(e);
			if (i) for (var o in i) i.hasOwnProperty(o) && (n = k.setQuery(n, o, i[o]));
			else {
				e.length && (e = e[0]);
				for (var a = j.urlExtend || [], u = 0, c = a.length; u < c; u++) {
					var d = a[u],
					f = e.getAttribute("data-ext-" + d);
					f && (n = k.setQuery(n, d, f))
				}
			}
			return n
		},
		refreshPtp: function() {
			F = a(),
			u()
		},
		refreshE: function() {
			H && (H.e = q.rand(6))
		}
	},
	z = 0,
	D = {
		sendLog: function(e, t) {
			T.isLowIE ? d(e, t) : c(e, t)
		},
		sendAppLog: function(e, t) {
			return e += "",
			j.nativeLog && j.nativeLog.logE ? j.nativeLog.logE(e, t) : void(window.hdp && window.hdp.exec ? hdp.exec("mgj.tracker.sendEvent", e, t) : document.addEventListener("deviceready",
			function() {
				window.mgj && mgj.tracker && mgj.tracker.sendEvent && mgj.tracker.sendEvent(e, t)
			},
			!1))
		},
		logAppPevent: function(e, t) {
			return j.nativeLog && j.nativeLog.logP ? j.nativeLog.logP(e, t) : void(window.hdp && window.hdp.exec ? hdp.exec("mgj.pevent", e, t).then(function() {},
			function() {}) : document.addEventListener("deviceready",
			function() {
				window.mgj && mgj.pevent && mgj.pevent(function() {},
				null, e)
			},
			!1))
		},
		logData: function(e, t) {
			var n = V.getPtpByType(e),
			r = t.eid;
			if (n.push(k.stringify(t)), T.isNative) {
				var i = t.ext;
				i.ptp_cnt = t.ptp_cnt,
				i.ptp_url = t.ptp_url,
				i.ptp_ref = t.ptp_ref,
				i.uid = t.uid,
				D.sendAppLog(r, i)
			} else D.sendLog(j.LogUrl, {
				v: 2,
				pt: k.getTime(),
				pf: V.getPlatform(),
				data: n.join("\t")
			})
		}
	},
	J = [],
	K = !1,
	W = !1,
	X = T.isNative || !j.shouldRequestCookie();
	X || k.loadScript(j.CookieUrl,
	function() {
		X = !0,
		k.fire("LoggerReady")
	},
	T.xcore),
	"undefined" == typeof location.search && (location.search = location.href.split("#")[0]);
	var Z = {
		version: "1.1.0",
		ptp: V,
		config: j,
		util: k,
		info: T,
		send: D,
		refreshPevent: h,
		log: l,
		generatePtpParams: A,
		generatePtpForm: E,
		goTo: P
	};
	if (window.logger = Z, !T.xcore) {
		var G = "tap" in document.createElement("div") ? "tap": "mousedown";
		k.registerEvent(document, G, x),
		k.registerEvent(document, "touchstart", x)
	}
	return p(function() {
		V.refreshPtp(),
		m()
	}),
	Z
} ();
